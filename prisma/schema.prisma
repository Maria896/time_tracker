generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                 Int           @id @default(autoincrement())
  name               String
  email              String        @unique
  password           String
  role               UserRole?   
  designation        Designations?
  is_verified        Boolean       @default(false)
  verification_token String?
  token_expiration   DateTime?
  time_entries       TimeEntry[]
  organization_id    Int?
  organization        Organization? @relation("users", fields: [organization_id], references: [id])
  projects           UserProject[]
}

model Organization {
  id                Int      @id @default(autoincrement())
  organization_name String
  owner             String   @unique
  industry_type     INDUSTRY
  company_strength  Int
  employees         User[] @relation("users")
  created_at        DateTime @default(now())
}

model Project {
  id             Int           @id @default(autoincrement())
  project_name   String
  created_at     DateTime      @default(now())
  estimated_time DateTime
  actual_time    DateTime
  userId         Int
  status         ProjectStatus
  time_entries   TimeEntry[]
  users          UserProject[]
}

model UserProject {
  userId    Int
  projectId Int

  user    User    @relation(fields: [userId], references: [id])
  project Project @relation(fields: [projectId], references: [id])

  @@id([userId, projectId])
}

model TimeEntry {
  id         Int      @id @default(autoincrement())
  start_time DateTime
  end_time   DateTime
  userId     Int
  projectId  Int
  project    Project  @relation(fields: [projectId], references: [id])
  user       User     @relation(fields: [userId], references: [id])
}

enum UserRole {
  EMPLOYEE
  OWNER
}

enum Designations {
  ASSOCIATE_SOFTWARE_ENGINEER
  SOFTWARE_ENGINEER
  QA_EXECUTIVE
  PRODUCT_MANAGER
}

enum ProjectStatus {
  COMPLETED
  INPROGRESS
  STOPPED
}

enum INDUSTRY {
  MANUFACTURING
  SERVICE
  TECHNOLOGY
  HEALTHCARE
  FINANCIAL
  RETAIL
  ENERGY
  AGRICULTURE
  TRANSPORTATION
  ENTERTAINMENT
  CONSTRUCTION
  EDUCATION
}
